%!TEX root = ../Main.tex

\section{Transition systems}
\label{s:transition}
\input{figures/system-types.tex}

\autoref{f:system-types} shows the types of transition systems.
A transition system is parameterised by its input environment and the result type.
It also contains two internal environments: firstly, the state environment describes the private state required to execute the machine; secondly, the free environment contains any extra input values that the transition system would like to quantify over.
The free environment is used to allow the system to concoct arbitrary values, when it would not otherwise be able to return a concrete value.
For contracts which abstract over the implementation, the natural definition of the step function would involve an existential quantifier: there exists some value that satisfies the specification.
Unfortunately, such an existential quantifier requires a step \emph{relation} rather than a step \emph{function}.
Using a step relation with existential quantifiers complicates the resulting transition, as the quantifiers get between the value and its definition.
Instead, the free environment provides the step function with a fresh unconstrained value of the desired type, and the step function itself can constrain it however it wishes.

The free environment is used to generate similar systems to the transition systems generated by existing systems such as Kind2 \cite{champion2016kind2}, which can generate fresh variables at will.
The main distinction is that embedding such a translation inside a theorem prover and proving it correct requires some ingenuity.

\input{figures/system-translation.tex}

\TODO{describe translation}
The substitution-based semantics is better for equational reasoning, and (subjectively perhaps) simpler.
The transition system is better for certain automated proofs: a surprising number of interesting properties can be proven with k-induction alone.

\subsection{Translation correctness proofs}
\label{s:transition:proof}

\TODO{describe the proofs of translation correctness}
The translation to a transition system above is an abstraction.
We prove it.
Interesting lemmas etc.

