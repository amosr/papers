%!TEX root = ../Main.tex

\section{Proofs}
\label{s:Proofs}

Our fusion system is formalised in Coq, where we have proved soundness of \ti{fusePair}: if the fused program evaluates to a particular output, then the two original programs also evaluate to that output.
It is interesting to note that the converse is not necessarily true: just because two programs can evaluate to a particular output does not mean the fused program will evaluate to that.
This is because, as explained in~\S\ref{s:EvaluationOrder}, evaluation of a process network is non-deterministic, and fusion commits to a particular evaluation order.

The system described here has some differences to our Coq formalisation.
First, the Coq formalisation has a separate @update@ instruction which modifies a variable in the local heap, rather than allowing heap updates in the output \Next~label of any instruction.
This causes the fusion definition to be slightly more complicated, as two output instructions must be emitted when performing a push or pull followed by an update.
This is a fairly minor difference, and we have made this change in the paper version for ease of exposition.
Ideally, a future version of the formalisation would include this change.
Secondly, our formalisation does not implement the concurrent evaluation semantics for processes, only sequential evaluation for a single process.
Instead we sequentially evaluate both processes separately with the same input values and outputs.

Despite these differences, we believe the Coq formalisation gives sufficient confidence in the correctness of the version presented here.

